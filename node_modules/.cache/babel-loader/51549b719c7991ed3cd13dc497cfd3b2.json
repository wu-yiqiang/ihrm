{"remainingRequest":"C:\\Users\\windows\\Project\\ihrm\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\windows\\Project\\ihrm\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\windows\\Project\\ihrm\\src\\utils\\request.js","dependencies":[{"path":"C:\\Users\\windows\\Project\\ihrm\\src\\utils\\request.js","mtime":1616633176896},{"path":"C:\\Users\\windows\\Project\\ihrm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\windows\\Project\\ihrm\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\windows\\Project\\ihrm\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJzsKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgcm91dGVyIGZyb20gJ0Avcm91dGVyJzsKaW1wb3J0IHsgZ2V0VGltZVN0YW1wIH0gZnJvbSAnQC91dGlscy9hdXRoJzsKdmFyIFRpbWVPdXQgPSAzNjAwOyAvLyDorr7nva7otoXml7bml7bpl7QKCnZhciBzZXJ2aWNlID0gYXhpb3MuY3JlYXRlKHsKICBiYXNlVVJMOiBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJLAogIHRpbWVvdXQ6IDUwMDAKfSk7Ci8qIOivt+axguaLpuaIquWZqCAqLwoKc2VydmljZS5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoZnVuY3Rpb24gKGNvbmZpZykgewogIC8vIOazqOWFpXRva2VuCiAgaWYgKHN0b3JlLmdldHRlcnMudG9rZW4pIHsKICAgIGlmIChjaGVja1RpbWVPdXQoKSkgewogICAgICBzdG9yZS5kaXNwYXRjaCgnbG9nb3V0Jyk7CiAgICAgIHJvdXRlci5wdXNoKCcvbG9naW4nKTsKICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcigndG9rZW7otoXml7YnKSk7CiAgICB9CgogICAgY29uZmlnLmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9ICJCZWFyZXIgIi5jb25jYXQoc3RvcmUuZ2V0dGVycy50b2tlbik7CiAgfQoKICByZXR1cm4gY29uZmlnOwp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwp9KTsKLyog5ZON5bqU5oum5oiq5ZmoICovCgpzZXJ2aWNlLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgdmFyIF9yZXNwb25zZSRkYXRhID0gcmVzcG9uc2UuZGF0YSwKICAgICAgc3VjY2VzcyA9IF9yZXNwb25zZSRkYXRhLnN1Y2Nlc3MsCiAgICAgIGRhdGEgPSBfcmVzcG9uc2UkZGF0YS5kYXRhLAogICAgICBtZXNzYWdlID0gX3Jlc3BvbnNlJGRhdGEubWVzc2FnZTsKCiAgaWYgKHN1Y2Nlc3MpIHsKICAgIHJldHVybiBkYXRhOwogIH0gZWxzZSB7CiAgICBNZXNzYWdlLmVycm9yKG1lc3NhZ2UpOwogICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihtZXNzYWdlKSk7CiAgfQp9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICBpZiAoZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UuZGF0ZSAmJiBlcnJvci5yZXNwb25zZS5kYXRlLmNvZGUgPT0gMTAwMDIpIHsKICAgIC8vIOacjeWKoeWZqOi/lOWbnumUmeivr+egge+8jHRva2Vu6LaF5pe2CiAgICAvLyDliKDpmaR0b2tlbgogICAgc3RvcmUuZGlzcGF0Y2goJ2xvZ291dCcpOwogICAgcm91dGVyLnB1c2goJy9sb2dpbicpOwogIH0gZWxzZSB7CiAgICBNZXNzYWdlLmVycm9yKGVycm9yLm1lc3NhZ2UpOwogIH0KCiAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTsKfSk7Ci8qIOajgOafpXRva2Vu5piv5ZCm6LaF5pe2ICovCgpmdW5jdGlvbiBjaGVja1RpbWVPdXQocGFyYW1zKSB7CiAgdmFyIGN1cnJlbnRUaW1lID0gRGF0ZS5ub3coKTsKICB2YXIgdGltZVN0YW1wID0gZ2V0VGltZVN0YW1wKCk7CiAgcmV0dXJuIChjdXJyZW50VGltZSAtIHRpbWVTdGFtcCkgLyAxMDAwID4gVGltZU91dDsKfQoKZXhwb3J0IGRlZmF1bHQgc2VydmljZTs="},{"version":3,"sources":["C:/Users/windows/Project/ihrm/src/utils/request.js"],"names":["axios","Message","store","router","getTimeStamp","TimeOut","service","create","baseURL","process","env","VUE_APP_BASE_API","timeout","interceptors","request","use","config","getters","token","checkTimeOut","dispatch","push","Promise","reject","Error","headers","error","response","data","success","message","date","code","params","currentTime","Date","now","timeStamp"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,SAAQC,YAAR,QAA2B,cAA3B;AACA,IAAMC,OAAO,GAAG,IAAhB,C,CAAqB;;AACrB,IAAMC,OAAO,GAAGN,KAAK,CAACO,MAAN,CAAa;AAC3BC,EAAAA,OAAO,EAAEC,OAAO,CAACC,GAAR,CAAYC,gBADM;AAE3BC,EAAAA,OAAO,EAAE;AAFkB,CAAb,CAAhB;AAIA;;AACAN,OAAO,CAACO,YAAR,CAAqBC,OAArB,CAA6BC,GAA7B,CAAiC,UAAAC,MAAM,EAAI;AACzC;AACA,MAAId,KAAK,CAACe,OAAN,CAAcC,KAAlB,EAAyB;AACvB,QAAIC,YAAY,EAAhB,EAAoB;AAClBjB,MAAAA,KAAK,CAACkB,QAAN,CAAe,QAAf;AACAjB,MAAAA,MAAM,CAACkB,IAAP,CAAY,QAAZ;AACA,aAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,SAAV,CAAf,CAAP;AACD;;AACDR,IAAAA,MAAM,CAACS,OAAP,CAAe,eAAf,qBAA4CvB,KAAK,CAACe,OAAN,CAAcC,KAA1D;AACD;;AACD,SAAOF,MAAP;AACD,CAXD,EAWG,UAAAU,KAAK,EAAI;AACV,SAAOJ,OAAO,CAACC,MAAR,CAAeG,KAAf,CAAP;AACD,CAbD;AAcA;;AACApB,OAAO,CAACO,YAAR,CAAqBc,QAArB,CAA8BZ,GAA9B,CAAkC,UAACY,QAAD,EAAe;AAAA,uBACZA,QAAQ,CAACC,IADG;AAAA,MACvCC,OADuC,kBACvCA,OADuC;AAAA,MAC9BD,IAD8B,kBAC9BA,IAD8B;AAAA,MACxBE,OADwB,kBACxBA,OADwB;;AAE/C,MAAID,OAAJ,EAAa;AACX,WAAOD,IAAP;AACD,GAFD,MAEO;AACL3B,IAAAA,OAAO,CAACyB,KAAR,CAAcI,OAAd;AACA,WAAOR,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAUM,OAAV,CAAf,CAAP;AACF;AACD,CARD,EAQG,UAACJ,KAAD,EAAW;AACZ,MAAKA,KAAK,CAACC,QAAN,IAAkBD,KAAK,CAACC,QAAN,CAAeI,IAAjC,IAAyCL,KAAK,CAACC,QAAN,CAAeI,IAAf,CAAoBC,IAApB,IAA4B,KAA1E,EAAiF;AAC/E;AACA;AACA9B,IAAAA,KAAK,CAACkB,QAAN,CAAe,QAAf;AACAjB,IAAAA,MAAM,CAACkB,IAAP,CAAY,QAAZ;AACD,GALD,MAKO;AACLpB,IAAAA,OAAO,CAACyB,KAAR,CAAcA,KAAK,CAACI,OAApB;AACD;;AACD,SAAOR,OAAO,CAACC,MAAR,CAAeG,KAAf,CAAP;AACD,CAlBD;AAoBA;;AACA,SAASP,YAAT,CAAsBc,MAAtB,EAA8B;AAC5B,MAAIC,WAAW,GAAGC,IAAI,CAACC,GAAL,EAAlB;AACA,MAAIC,SAAS,GAAGjC,YAAY,EAA5B;AACA,SAAO,CAAC8B,WAAW,GAAGG,SAAf,IAA4B,IAA5B,GAAmChC,OAA1C;AACD;;AACD,eAAeC,OAAf","sourcesContent":["import axios from 'axios'\nimport { Message } from 'element-ui'\nimport store from '@/store'\nimport router from '@/router'\nimport {getTimeStamp} from '@/utils/auth'\nconst TimeOut = 3600 // 设置超时时间\nconst service = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API,\n  timeout: 5000,\n})\n/* 请求拦截器 */\nservice.interceptors.request.use(config => {\n  // 注入token\n  if (store.getters.token) {\n    if (checkTimeOut()) {\n      store.dispatch('logout')\n      router.push('/login')\n      return Promise.reject(new Error('token超时'))\n    }\n    config.headers['Authorization'] = `Bearer ${store.getters.token}`\n  }\n  return config\n}, error => {\n  return Promise.reject(error)\n})\n/* 响应拦截器 */\nservice.interceptors.response.use((response)  => {\n  const { success, data, message } = response.data\n  if (success) {\n    return data\n  } else {\n    Message.error(message)\n    return Promise.reject(new Error(message))\n } \n}, (error) => {\n  if ( error.response && error.response.date && error.response.date.code == 10002) {\n    // 服务器返回错误码，token超时\n    // 删除token\n    store.dispatch('logout')\n    router.push('/login')\n  } else {\n    Message.error(error.message)\n  }\n  return Promise.reject(error)\n})\n\n/* 检查token是否超时 */\nfunction checkTimeOut(params) {\n  var currentTime = Date.now()\n  var timeStamp = getTimeStamp()\n  return (currentTime - timeStamp) / 1000 > TimeOut \n}\nexport default service "]}]}